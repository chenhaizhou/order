(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{"0eb4":function(e,s,t){"use strict";var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.show?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[e.isSuccess?t("div",{staticClass:"success"},[t("i",{staticClass:"icon"}),t("p",{staticClass:"msg"},[e._v(e._s(e.msg))])]):t("div",{staticClass:"fail"},[t("i",{staticClass:"icon-err"}),t("p",{staticClass:"msg"},[e._v(e._s(e.msg))])]),t("div",{staticClass:"button",on:{click:e.close}},[e._v("确认")])])]):e._e()},n=[],i={props:{show:Boolean,msg:String,isSuccess:Boolean},data:function(){return{}},methods:{close:function(){this.$emit("close")}}},r=i,o=(t("c02f"),t("2877")),c=Object(o["a"])(r,a,n,!1,null,"1e171857",null);s["a"]=c.exports},1511:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"form"},[e._m(0),t("ul",{staticClass:"field-group"},[t("li",{ref:"uid",staticClass:"field-item"},[t("label",{attrs:{for:"uid"}},[e._v("职工编号:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.uid,expression:"user.uid"}],attrs:{type:"text",id:"uid",placeholder:"请填写职工编号",disabled:e.disabledForm},domProps:{value:e.user.uid},on:{change:e.change,blur:e.change,input:function(s){s.target.composing||e.$set(e.user,"uid",s.target.value)}}})]),t("li",{ref:"username",staticClass:"field-item"},[t("label",{attrs:{for:"username"}},[e._v("用户名:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],attrs:{type:"text",id:"username",placeholder:"请填写用户名",disabled:e.disabledForm},domProps:{value:e.user.username},on:{change:e.change,blur:e.change,input:function(s){s.target.composing||e.$set(e.user,"username",s.target.value)}}})]),t("li",{ref:"idCard",staticClass:"field-item"},[t("label",{attrs:{for:"idCard"}},[e._v("身份证号:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.idCard,expression:"user.idCard"}],attrs:{type:"text",id:"idCard",placeholder:"请填写身份证号",disabled:e.disabledForm},domProps:{value:e.user.idCard},on:{change:e.change,blur:e.change,input:function(s){s.target.composing||e.$set(e.user,"idCard",s.target.value)}}})]),t("li",{ref:"phone",staticClass:"field-item"},[t("label",{attrs:{for:"phone"}},[e._v("联系电话:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.phone,expression:"user.phone"}],attrs:{type:"phone",id:"phone",placeholder:"请填写联系电话",disabled:e.disabledForm},domProps:{value:e.user.phone},on:{change:e.change,blur:e.change,input:function(s){s.target.composing||e.$set(e.user,"phone",s.target.value)}}})])]),t("div",{staticClass:"btn-box"},[e.disabledForm?t("input",{staticClass:"cancel",attrs:{type:"cancel",value:"取消绑定"},on:{click:e.cancel}}):t("input",{staticClass:"submit",attrs:{type:"submit",value:"绑定身份"},on:{click:e.submit}})]),t("Toast",{attrs:{show:e.showToast,isSuccess:e.isSuccess,msg:e.msg},on:{close:e.closeToast}})],1)},n=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("header",{staticClass:"header"},[t("strong",[e._v("账号绑定")])])}],i=(t("7f7f"),t("bc3a")),r=t.n(i),o=t("01ea"),c=function(e,s){var t={uid:function(e){return!!e},username:function(e){return!!e},idCard:function(e){return/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(e)},phone:function(e){return/1\d{10}$/.test(e)}},a={uid:"请输入职工编号",username:"请输入用户名",idCard:"请输入正确身份证号",phone:"请输入正确手机号"};if(!t[e](s))return a[e]},u=t("0eb4"),d={components:{Toast:u["a"]},data:function(){return{showToast:!1,msg:"",isSuccess:!1,user:{username:"",uid:"",idCard:"",phone:""},disabledForm:!1}},mounted:function(){this.getUser("admin")},methods:{closeToast:function(){this.showToast=!1},submit:function(){this.validate()&&console.log("submit")},cancel:function(){console.log("cancel")},change:function(e){var s,t=e.target,a=t.id,n=t.value,i=c(a,n);i?(this.$refs[a].classList.add("error"),this.$refs[a].querySelector(".err-msg")||(s=document.createElement("p"),s.className="err-msg",this.$refs[a].appendChild(s)),this.$refs[a].querySelector(".err-msg").innerText=i):(this.$refs[a].classList.remove("error"),this.$refs[a].querySelector(".err-msg")&&this.$refs[a].removeChild(this.$refs[a].querySelector(".err-msg")))},validate:function(){var e=this,s=["uid","username","idCard","phone"];return s.map((function(s){var t={target:{id:s,value:e.user[s]}};e.change(t)})),0===document.querySelectorAll(".field-group .err-msg").length},getUser:function(e){var s=this;r.a.get("".concat(o["a"],"/dinner/a/wechat/api/user/getUser"),{params:{loginName:e}}).then((function(e){if(e.data.body.user){var t=e.data.body.user,a=t.id,n=t.loginName,i=t.name,r=t.mobile,o=t.idcard,c=t.openId;s.user={id:a,openId:c,uid:n,username:i,phone:r,idCard:o},c&&n&&(s.disabledForm=!0)}})).catch((function(e){console.log(e)}))},bindUser:function(e){var s=this,t=e.uid,a=e.username,n=e.phone,i=e.idCard,c=localStorage.getItem("openId");r.a.post("".concat(o["a"],"/dinner/a/wechat/api/user/binding"),{openId:c,loginName:t,name:a,mobile:n,idcard:i}).then((function(e){s.bindUser={status:e.success,msg:e.msg}})).catch((function(e){console.log(e)}))},unBindUser:function(){var e=this,s=this.user,t=s.uid,a=s.openId;r.a.post("".concat(o["a"],"/dinner/a/wechat/api/user/unbinding"),{openId:a,loginName:t}).then((function(s){e.bindUser={status:s.success,msg:s.msg}})).catch((function(e){console.log(e)}))}}},l=d,m=(t("1835"),t("2877")),f=Object(m["a"])(l,a,n,!1,null,"f01a49e4",null);s["default"]=f.exports},1835:function(e,s,t){"use strict";var a=t("f200"),n=t.n(a);n.a},"7f7f":function(e,s,t){var a=t("86cc").f,n=Function.prototype,i=/^\s*function ([^ (]*)/,r="name";r in n||t("9e1e")&&a(n,r,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},c02f:function(e,s,t){"use strict";var a=t("f93d"),n=t.n(a);n.a},f200:function(e,s,t){},f93d:function(e,s,t){}}]);
//# sourceMappingURL=user.f152daef.js.map